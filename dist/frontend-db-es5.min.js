!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).window=e.window||{})}(this,(function(e){"use strict";function t(){t=function(){return e};var e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof d?t:d,a=Object.create(i.prototype),c=new D(n||[]);return o(a,"_invoke",{value:k(e,r,c)}),a}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var l={};function d(){}function p(){}function v(){}var y={};u(y,a,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(E([])));w&&w!==r&&n.call(w,a)&&(y=w);var m=v.prototype=d.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,i,a,c){var s=h(e[o],e,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(f).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function k(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=O(a,r);if(c){if(c===l)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=h(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function O(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=h(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=v,o(m,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:p,configurable:!0}),p.displayName=u(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(x.prototype),u(x.prototype,c,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new x(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(m),u(m,s,"Generator"),u(m,a,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=E,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function c(e){n(a,o,i,c,s,"next",e)}function s(e){n(a,o,i,c,s,"throw",e)}c(void 0)}))}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function h(e,t){if(!t)return e;var r=[],n=new Set(e);return t.forEach((function(e){n.has(e)&&r.push(e)})),r}var l=function(){function e(t,r,n){i(this,e),s(this,"db",void 0),s(this,"schema",void 0),s(this,"idbObjectStore",void 0),s(this,"name",void 0),this.db=t,this.name=r,this.schema=n,this.idbObjectStore=null}var n,a,u,l,d;return c(e,[{key:"prepare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"readonly";this.idbObjectStore=this.db.getIDBObjectStore(this.name,e)}},{key:"getIndexes",value:function(){return this.prepare(),this.idbObjectStore.indexNames}},{key:"copy",value:(d=o(t().mark((function e(r){var n,o,i,a,c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.prepare(),e.next=3,this.db.createStore(r,{},this.idbObjectStore.autoIncrement,this.idbObjectStore.indexNames);case 3:return n=e.sent,e.next=6,this.getAllRecordsWithKeys();case 6:o=e.sent,i=f(o),e.prev=8,i.s();case 10:if((a=i.n()).done){e.next=16;break}return c=a.value,e.next=14,n.addRecord(c[1],c[0]);case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}}),e,this,[[8,18,21,24]])}))),function(e){return d.apply(this,arguments)})},{key:"addRecord",value:function(e,r){var n=this;return this.prepare("readwrite"),new Promise(function(){var i=o(t().mark((function o(i,a){var c;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{(c=n.idbObjectStore.add(e,r)).onsuccess=function(e){i(e.target.result)},c.onerror=function(e){a(e.target.error)}}catch(e){a(e)}case 1:case"end":return t.stop()}}),o)})));return function(e,t){return i.apply(this,arguments)}}())}},{key:"clearAllRecords",value:(l=o(t().mark((function e(){var r=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.prepare("readwrite"),e.abrupt("return",new Promise(function(){var e=o(t().mark((function e(n,o){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(i=r.idbObjectStore.clear()).onsuccess=function(e){n()},i.onerror=function(e){o(e.target.error)}}catch(e){o(e)}case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"getRecord",value:function(e){var r=this;return this.prepare(),new Promise(function(){var n=o(t().mark((function n(o,i){var a;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=r.idbObjectStore.get(e)).onsuccess=function(t){var n=t.target.result;void 0!==n?o(n):i(new DOMException("Key '".concat(e,"' doesn't exist in store '").concat(r.name,"'. To add a record with this key, use addRecord().")))},a.onerror=function(e){i(e.target.error)};case 3:case"end":return t.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getAllRecords",value:function(){var e=this;return this.prepare(),new Promise(function(){var r=o(t().mark((function r(n,o){var i;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(i=e.idbObjectStore.getAll()).onsuccess=function(e){var t=e.target.result;n(t)},i.onerror=function(e){o(e.target.error)};case 3:case"end":return t.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getAllKeys",value:function(){var e=this;return this.prepare(),new Promise(function(){var r=o(t().mark((function r(n,o){var i;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(i=e.idbObjectStore.getAllKeys()).onsuccess=function(e){var t=e.target.result;n(t)},i.onerror=function(e){o(e.target.error)};case 3:case"end":return t.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"getAllRecordsWithKeys",value:(u=o(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAllRecords();case 2:return r=e.sent,e.next=5,this.getAllKeys();case 5:return n=e.sent,e.abrupt("return",r.map((function(e,t){return[n[t],e]})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"existsRecord",value:(a=o(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getRecord(r);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e){return a.apply(this,arguments)})},{key:"deleteRecord",value:function(e){var r=this;return new Promise(function(){var n=o(t().mark((function n(o,i){var a;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.existsRecord(e);case 2:if(t.sent){t.next=5;break}return i(new DOMException("Key '".concat(e,"' doesn't exist in store '").concat(r.name,"'. To add a record with this key, use addRecord()."))),t.abrupt("return");case 5:r.prepare("readwrite"),(a=r.idbObjectStore.delete(e)).onsuccess=function(e){o()},a.onerror=function(e){i(e.target.error)};case 9:case"end":return t.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"updateRecord",value:function(e,n){var i=this;return new Promise(function(){var a=o(t().mark((function o(a,c){var s,u,f;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.existsRecord(e);case 2:if(t.sent){t.next=5;break}return c(new DOMException("Key '".concat(e,"' doesn't exist in store '").concat(i.name,"'. To add a record with this key, use addRecord()."))),t.abrupt("return");case 5:if("object"===r(n)){t.next=8;break}return c(new DOMException("Second argument to updateRecord() must be an object. Currently, a '".concat(r(n),"' was provided."))),t.abrupt("return");case 8:return t.next=10,i.getRecord(e);case 10:s=t.sent,u=Object.assign(s,n),i.prepare("readwrite"),(f=i.idbObjectStore.put(u,e)).onsuccess=function(e){a()},f.onerror=function(e){c(e.target.error)};case 16:case"end":return t.stop()}}),o)})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"searchRecords",value:function(e,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.getIndexes().contains(e);return this.prepare(),new Promise(function(){var c=o(t().mark((function o(c,s){var u;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.run(n.idbObjectStore,e,a,i);case 2:u=t.sent,c(u);case 4:case"end":return t.stop()}}),o)})));return function(e,t){return c.apply(this,arguments)}}())}},{key:"searchRecordsAdvanced",value:(n=o(t().mark((function e(r){var n,o,i,a,c,s,u,l,d,p=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=p.length>1&&void 0!==p[1]&&p[1],e.t0=t().keys(r);case 2:if((e.t1=e.t0()).done){e.next=11;break}return i=e.t1.value,a=r[i],e.next=7,this.searchRecords(i,a);case 7:c=e.sent,o=h(c,o),e.next=2;break;case 11:if(n){e.next=13;break}return e.abrupt("return",o);case 13:s=[],u=f(o),e.prev=15,u.s();case 17:if((l=u.n()).done){e.next=26;break}return d=l.value,e.t2=s,e.next=22,this.getRecord(d);case 22:e.t3=e.sent,e.t2.push.call(e.t2,e.t3);case 24:e.next=17;break;case 26:e.next=31;break;case 28:e.prev=28,e.t4=e.catch(15),u.e(e.t4);case 31:return e.prev=31,u.f(),e.finish(31);case 34:return e.abrupt("return",s);case 35:case"end":return e.stop()}}),e,this,[[15,28,31,34]])}))),function(e){return n.apply(this,arguments)})}]),e}(),d=function(){function e(t,r,n){i(this,e),s(this,"isIndexSearchCompatible",void 0),s(this,"idbKeyRange",void 0),s(this,"recordMatcher",void 0),this.isIndexSearchCompatible=t,r instanceof IDBKeyRange?(this.idbKeyRange=r,this.recordMatcher=n):this.recordMatcher=r}var r;return c(e,[{key:"runForIndexing",value:function(e,t,r){var n=this;return new Promise((function(o,i){var a=e.index(t)[r?"getAll":"getAllKeys"](n.idbKeyRange);a.onsuccess=function(e){o(e.target.result)},a.onerror=function(e){i(e)}}))}},{key:"runForLinearSearch",value:function(e,r,n){var i=this;return new Promise((function(a,c){var s=[],u=e.openCursor();u.onsuccess=function(){var e=o(t().mark((function e(o){var c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(c=o.target.result)?(i.recordMatcher(r,c.value)&&s.push(n?c.value:c.key),c.continue()):a(s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.onerror=function(e){c(e)}}))}},{key:"run",value:(r=o(t().mark((function e(r,n,o,i){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o||!this.isIndexSearchCompatible){e.next=6;break}return e.next=3,this.runForIndexing(r,n,i);case 3:a=e.sent,e.next=9;break;case 6:return e.next=8,this.runForLinearSearch(r,n,i);case 8:a=e.sent;case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o){return r.apply(this,arguments)})}]),e}();function p(e,t){return function(r){if("number"==typeof r||"string"==typeof r)return new d(!0,e(r),t.bind(null,r));throw new DOMException("".concat(e.name,"() can only be called with a number or a string."))}}var v=p((function(e){return IDBKeyRange.lowerBound(e,!0)}),(function(e,t,r){return r[t]>e})),y=p((function(e){return IDBKeyRange.lowerBound(e)}),(function(e,t,r){return r[t]>=e})),b=p((function(e){return IDBKeyRange.upperBound(e,!0)}),(function(e,t,r){return r[t]<e})),w=p((function(e){return IDBKeyRange.upperBound(e)}),(function(e,t,r){return r[t]<=e})),m=p((function(e){return IDBKeyRange.only(e)}),(function(e,t,r){return r[t]===e}));var g=function(){function e(t){i(this,e),s(this,"idb",void 0),s(this,"name",void 0),s(this,"storeNames",void 0),s(this,"stores",void 0),s(this,"deleted",void 0),s(this,"closed",void 0),this.idb=t,this.name=t.name,this.storeNames=t.objectStoreNames,this.stores={},this.deleted=!1,this.closed=!1}var r,n,a;return c(e,[{key:"throwIfDeletedOrClosedOrClosed",value:function(){if(this.deleted)throw new DOMException("The underlying IndexedDB database '".concat(this.name,"' has been deleted. You'll have to create the database using Database.open(), and then use the returned Database instance to perform any further actions on the underlying database."));if(this.closed)throw new DOMException("The underlying IndexedDB database '".concat(this.name,"' has been closed. You'll have to open a new connection using Database.open(), and then use the returned Database instance to perform any further actions on the underlying database."))}},{key:"removeFromOpenConnections",value:function(){e.openConnections.splice(e.openConnections.indexOf(this.name),1)}},{key:"close",value:function(){this.throwIfDeletedOrClosedOrClosed(),this.removeFromOpenConnections(),this.idb.close()}},{key:"delete",value:function(){var e=this;return this.throwIfDeletedOrClosedOrClosed(),new Promise((function(t,r){e.close();var n=indexedDB.deleteDatabase(e.name);n.onsuccess=function(r){e.removeFromOpenConnections(),e.idb=null,e.stores={},e.deleted=!0,t()},n.onerror=function(e){r(e.target.error)}}))}},{key:"versionChange",value:function(e){var t=this;return new Promise((function(r,n){t.close();var o=indexedDB.open(t.name,t.idb.version+1);o.onupgradeneeded=function(o){t.idb=o.target.result;try{var i=e();t.storeNames=t.idb.objectStoreNames,o.target.transaction.oncomplete=function(e){r(i)}}catch(o){n(o)}},o.onerror=function(e){n(e)}}))}},{key:"createIDBStore",value:function(e,t,r){var n={};"boolean"==typeof t?n.autoIncrement=t:"string"==typeof t&&(n.keyPath=t);var o=this.idb.createObjectStore(e,n);if(r){var i,a=f(r);try{for(a.s();!(i=a.n()).done;){var c=i.value;o.createIndex(c,c)}}catch(e){a.e(e)}finally{a.f()}}return o}},{key:"createStore",value:(a=o(t().mark((function e(r,n,o,i){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDeletedOrClosedOrClosed(),e.next=3,this.versionChange(this.createIDBStore.bind(this,r,o,i));case 3:return a=new l(this,r,n),this.stores[r]=a,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"getIDBObjectStore",value:function(e,t){return this.idb.transaction(e,t).objectStore(e)}},{key:"getStore",value:function(e){if(this.throwIfDeletedOrClosedOrClosed(),this.existsStore(e))return this.stores[e]||(this.stores[e]=new l(this,e)),this.stores[e];throw new DOMException("Object store '".concat(e,"' doesn't exist. Create it first using createStore()."))}},{key:"deleteIDBObjectStore",value:function(e){return this.idb.deleteObjectStore(e)}},{key:"deleteStore",value:(n=o(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDeletedOrClosedOrClosed(),e.next=3,this.versionChange(this.deleteIDBObjectStore.bind(this,r));case 3:delete this.stores[r];case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"existsStore",value:function(e){return this.throwIfDeletedOrClosedOrClosed(),this.storeNames.contains(e)}}],[{key:"open",value:function(t){return new Promise((function(r,n){if(e.openConnections.includes(t))throw new DOMException("Connection to database '".concat(t,"' already exists. A connection to a database must be closed before a new one can be opened."));var o=indexedDB.open(t);o.onsuccess=function(n){e.openConnections.push(t),r(new e(n.target.result))},o.onerror=function(e){n(e)}}))}},{key:"exists",value:(r=o(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,indexedDB.databases();case 2:return n=e.sent,e.abrupt("return",n.some((function(e){return e.name===r})));case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}]),e}();s(g,"openConnections",[]),e.Database=g,e.DatabaseStore=l,e.default=g,e.hasKeys=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new d(!1,(function(e,r){var n,o=r[e],i=f(t);try{for(i.s();!(n=i.n()).done;){if(!(n.value in o))return!1}}catch(e){i.e(e)}finally{i.f()}return!0}))},e.isEqualTo=m,e.isGreaterThan=v,e.isGreaterThanEqualTo=y,e.isLessThan=b,e.isLessThanEqualTo=w,e.isLike=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"!=typeof e)throw new DOMException("isLike() can only be called with strings.");var r=new RegExp("^"+e.replace(/%+/g,".*")+"$",t?"i":"");return new d(!1,(function(e,t){return r.test(t[e])}))},Object.defineProperty(e,"__esModule",{value:!0})}));
